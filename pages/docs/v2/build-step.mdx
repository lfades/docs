import Doc from '~/components/layout/docs'
import { TerminalInput } from '~/components/text/terminal'
import { GenericLink } from '~/components/text/link'
import Caption from '~/components/text/caption'
import Now from '~/components/text/now'
import Note from '~/components/text/note'
import Card from '~/components/card'
import { InlineCode } from '~/components/text/code'
import { P } from '~/components/text/paragraph'

export const meta = {
  title: 'Build Step',
  description: 'Providing ZEIT Now with a build step.',
  editUrl: 'pages/docs/v2/build-step.mdx',
  lastEdited: '2019-07-19T17:33:07.000Z'
}

To build your project, Now looks for a build script inside of a `package.json` file. By providing a build script, Now will build your project from fresh on every deployment.

It is also possible that your build script will require an environment variable, allowing to behave differently, based on the environment it is building for.

Adding environment variables requires two steps, defining the environment variable as a secret, then making it available to your build process.

## Adding Secrets

To define an environment variable, you should use **Now Secrets**. By using **Now Secrets**, the data will be encrypted and stored securely, no longer directly accessible by anyone, and only exposed to deployments as environment variables.

Adding **Now Secrets** can be done with [Now ClI](/now), providing three options to work with them.

To **define a Now Secret**, use the following command:

<TerminalInput><P.B>now secrets add </P.B>secret-name secret-value</TerminalInput>
<Caption>Defining a <P.B>Now Secret</P.B> using <GenericLink href="/now">Now CLI</GenericLink>.</Caption>

To **remove a Now Secret**, use the following command:

<TerminalInput><P.B>now secrets rm </P.B>secret-name</TerminalInput>
<Caption>Removing a <P.B>Now Secret</P.B> using <GenericLink href="/now">Now CLI</GenericLink>.</Caption>

To **rename a Now Secret**, use the following command:

<TerminalInput><P.B>now secrets rename </P.B>secret-name new-name</TerminalInput>
<Caption>Renaming a <P.B>Now Secret</P.B> using <GenericLink href="/now">Now CLI</GenericLink>.</Caption>

## Providing Environment Variables

To provide your project with environment variables during the build script, you should create a `now.json` file like the one below:

```json
{
  "build": {
    "env": {
      "VARIABLE_NAME": "@secret-name"
    }
  }
}
```

<Caption>
  An example <InlineCode>now.json</InlineCode> file that provides an
  application's build step with a defined environment variable.
</Caption>

To use the environment variable from inside the application you would need to reference it using the correct syntax for the language being used. For example, using Node.js, the syntax would be:

```
process.env.VARIABLE_NAME
```

<Caption>
  Accessing a defined environment variable from within a Node.js application.
</Caption>

Now, whenever the `process.env.VARIABLE_NAME` key is used, it will provide the application's build step with the value declared by the referenced **Now Secret**.

## Related

For more information on what to do next, we recommend the following articles:

<Card title="Git Integration" href="/docs/v2/git-integration">
  Learn more about how ZEIT Now integrates with Git to make your workflow
  easier.
</Card>

<Card
  title="Aliasing Your Projects"
  href="/docs/v2/custom-domains#aliasing-a-project"
>
  Once deployed, your projects can be aliased to a custom domain or specified
  name or your choice to give it a primary place to see the latest version of
  your application.
</Card>

export default ({ children }) => <Doc meta={meta}>{children}</Doc>
